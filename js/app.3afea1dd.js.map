{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/views/MapUS.vue?048a","webpack:///./src/App.vue?7485","webpack:///./src/App.vue","webpack:///./src/views/MapUS.vue?ac77","webpack:///./src/utils/GrowingPacker.js","webpack:///src/views/MapUS.vue","webpack:///./src/views/MapUS.vue?8fcc","webpack:///./src/views/MapUS.vue","webpack:///./src/router.js","webpack:///./src/store.js","webpack:///./src/main.js","webpack:///./src/App.vue?f81e"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","app","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_MapUS_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_MapUS_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0___default","Appvue_type_template_id_3cccaabd_render","_vm","this","_h","$createElement","_c","_self","attrs","id","staticRenderFns","script","component","componentNormalizer","options","__file","App","MapUSvue_type_template_id_f3899f78_render","staticClass","_v","href","_s","counties","toLocaleString","ref","viewBox","preserveAspectRatio","_m","on","click","randomize","currentCounty","MapUSvue_type_template_id_f3899f78_staticRenderFns","GrowingPacker","blocks","len","w","h","root","x","y","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","iterator","next","done","block","node","findNode","fit","splitNode","growNode","err","return","used","right","down","canGrowDown","canGrowRight","shouldGrowRight","shouldGrowDown","growRight","growDown","OrbitControls","three_module","MapUSvue_type_script_lang_js_","scale","vertexShader","fragmentShader","canvasWidth","canvasHeight","mouse","mounted","createD3Map","runTexturePacker","drawCounties","createWebGLMap","methods","paths","$refs","querySelectorAll","index","Math","round","random","box","getBBox","setAttribute","width","height","concat","append","cloneNode","svg","d3","path","attr","selectAll","topojson","us_10m_v1","objects","features","enter","e","_this","toConsumableArray","map","_path$getBBox","parseInt","getAttribute","sort","a","b","min","packer","GrowingPacker_GrowingPacker","_this$counties","canvas","context","getContext","strokeStyle","lineWidth","fillStyle","canvasPacked","contextPacked","Path2D","stroke","fill","restore","save","translate","console","warn","camera","scene","renderer","controls","mesh","pickingRenderTarget","_this2","mouseIsDown","clock","pixelBuffer","Uint8Array","init","antialias","alpha","setPixelRatio","devicePixelRatio","setSize","extensions","position","z","enableKeys","enableZoom","maxPolarAngle","PI","document","addEventListener","render","getDelta","texture","generateMipmaps","minFilter","instances","countyIndexes","offsets","uvOffsets","uvScales","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","geometry","copy","maxInstancedCount","addAttribute","Float32Array","canvasTexture","material","uniforms","time","sineTime","isPicking","type","side","transparent","add","onWindowResize","event","pageX","offsetLeft","pageY","offsetTop","samplePoint","alert","aspect","updateProjectionMatrix","animate","requestAnimationFrame","children","needsUpdate","readRenderTargetPixels","log","code","county_names","views_MapUSvue_type_script_lang_js_","MapUS_component","MapUS","Vue","use","Router","router","routes","Vuex","store","Store","state","mutations","actions","config","productionTip","$mount","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_App_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_App_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0___default"],"mappings":"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","file":"js/app.3afea1dd.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"https://mikatalk.github.io/dataviz/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapUS.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapUS.vue?vue&type=style&index=0&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('router-view')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=3cccaabd&\"\nvar script = {}\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"App.vue\"\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"map-us\"},[_c('h1',[_vm._v(\"US Counties\")]),_c('h4',[_vm._v(\"Gather map data\")]),_c('p',[_vm._v(\"Following \"),_c('a',{attrs:{\"href\":\"https://bl.ocks.org/mbostock/4136647\"}},[_vm._v(\"this D3 example\")]),_vm._v(\",\\n  Create a SVG map of \"+_vm._s(_vm.counties.length.toLocaleString())+\" US counties.\")]),_c('svg',{ref:\"map-svg\",staticClass:\"map-svg\",attrs:{\"viewBox\":\"0 0 960 600\",\"preserveAspectRatio\":\"xMidYMid meet\"}}),_c('hr'),_c('h4',[_vm._v(\"Export Counties One by One\")]),_vm._m(0),_c('br'),_c('svg',{ref:\"test-svg\",staticClass:\"test-svg\",attrs:{\"preserveAspectRatio\":\"xMidYMid meet\"},on:{\"click\":_vm.randomize}}),_c('br'),_c('em',[_vm._v(\"Click on the SVG to randomize the state\")]),_c('hr'),_c('h4',[_vm._v(\"Draw to Canvas\")]),_c('p',[_vm._v(\"Redraw All \"+_vm._s(_vm.counties.length.toLocaleString())+\" US Counties onto a Canvas, using their coordinates\")]),_c('canvas',{ref:\"counties-canvas\",staticClass:\"counties-canvas\"}),_c('hr'),_c('h4',[_vm._v(\"Pack onto Canvas for Texture\")]),_c('p',[_vm._v(\"Redraw All \"+_vm._s(_vm.counties.length.toLocaleString())+\" US Counties onto a Canvas, using their packed positions\")]),_c('canvas',{ref:\"packed-counties-canvas\",staticClass:\"packed-counties-canvas\"}),_c('hr'),_c('h4',[_vm._v(\"Upload to the GPU\")]),_c('p',[_vm._v(\"Each county is mapped to an instanced 3d plane geometry with the right uv map.\")]),_c('h4',{staticClass:\"county-label\"},[_vm._v(_vm._s(_vm.currentCounty))]),_c('canvas',{ref:\"counties-webgl-canvas\",staticClass:\"counties-webgl-canvas\"})])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('p',[_vm._v(\" Next use \"),_c('em',[_vm._v(\"getBBox()\")]),_vm._v(\" to get each county bounds\")])}]\n\nexport { render, staticRenderFns }","/******************************************************************************\n\nhttps://github.com/jakesgordon/bin-packing/blob/master/js/packer.growing.js\n\nThis is a binary tree based bin packing algorithm that is more complex than\nthe simple Packer (packer.js). Instead of starting off with a fixed width and\nheight, it starts with the width and height of the first block passed and then\ngrows as necessary to accomodate each subsequent block. As it grows it attempts\nto maintain a roughly square ratio by making 'smart' choices about whether to\ngrow right or down.\nWhen growing, the algorithm can only grow to the right OR down. Therefore, if\nthe new block is BOTH wider and taller than the current target then it will be\nrejected. This makes it very important to initialize with a sensible starting\nwidth and height. If you are providing sorted input (largest first) then this\nwill not be an issue.\nA potential way to solve this limitation would be to allow growth in BOTH\ndirections at once, but this requires maintaining a more complex tree\nwith 3 children (down, right and center) and that complexity can be avoided\nby simply chosing a sensible starting block.\nBest results occur when the input blocks are sorted by height, or even better\nwhen sorted by max(width,height).\nInputs:\n------\n  blocks: array of any objects that have .w and .h attributes\nOutputs:\n-------\n  marks each block that fits with a .fit attribute pointing to a\n  node with .x and .y coordinates\nExample:\n-------\n  var blocks = [\n    { w: 100, h: 100 },\n    { w: 100, h: 100 },\n    { w:  80, h:  80 },\n    { w:  80, h:  80 },\n    etc\n    etc\n  ];\n  var packer = new GrowingPacker();\n  packer.fit(blocks);\n  for(var n = 0 ; n < blocks.length ; n++) {\n    var block = blocks[n];\n    if (block.fit) {\n      Draw(block.fit.x, block.fit.y, block.w, block.h);\n    }\n  }\n******************************************************************************/\n\nexport default class GrowingPacker {\n\n  fit (blocks) {\n    const len = blocks.length\n    var w = len > 0 ? blocks[0].w : 0\n    var h = len > 0 ? blocks[0].h : 0\n    this.root = { x: 0, y: 0, w: w, h: h }\n    for (let block of blocks) {\n      const node = this.findNode(this.root, block.w, block.h)\n      if (node)\n        block.fit = this.splitNode(node, block.w, block.h)\n      else\n        block.fit = this.growNode(block.w, block.h)\n    }\n  }\n\n  findNode (root, w, h) {\n    if (root.used)\n      return this.findNode(root.right, w, h) || this.findNode(root.down, w, h);\n    else if ((w <= root.w) && (h <= root.h))\n      return root\n    else\n      return null\n  }\n\n  splitNode (node, w, h) {\n    node.used = true;\n    node.down  = { x: node.x,     y: node.y + h, w: node.w,     h: node.h - h };\n    node.right = { x: node.x + w, y: node.y,     w: node.w - w, h: h          };\n    return node\n  }\n\n  growNode (w, h) {\n    var canGrowDown  = (w <= this.root.w)\n    var canGrowRight = (h <= this.root.h)\n\n    var shouldGrowRight = canGrowRight && (this.root.h >= (this.root.w + w)) // attempt to keep square-ish by growing right when height is much greater than width\n    var shouldGrowDown  = canGrowDown  && (this.root.w >= (this.root.h + h)) // attempt to keep square-ish by growing down  when width  is much greater than height\n\n    if (shouldGrowRight)\n      return this.growRight(w, h)\n    else if (shouldGrowDown)\n      return this.growDown(w, h)\n    else if (canGrowRight)\n     return this.growRight(w, h)\n    else if (canGrowDown)\n      return this.growDown(w, h)\n    else\n      return null // need to ensure sensible root starting size to avoid this happening\n  }\n\n  growRight (w, h) {\n    // console.log('new size (right):', w, h)\n    this.root = {\n      used: true,\n      x: 0,\n      y: 0,\n      w: this.root.w + w,\n      h: this.root.h,\n      down: this.root,\n      right: { x: this.root.w, y: 0, w: w, h: this.root.h }\n    }\n    const node = this.findNode(this.root, w, h)\n    if (node)\n      return this.splitNode(node, w, h)\n    else\n      return null;\n  }\n\n  growDown (w, h) {\n    // console.log('new size (down):', w, h)\n    this.root = {\n      used: true,\n      x: 0,\n      y: 0,\n      w: this.root.w,\n      h: this.root.h + h,\n      down:  { x: 0, y: this.root.h, w: this.root.w, h: h },\n      right: this.root\n    }\n    const node = this.findNode(this.root, w, h)\n    if (node)\n      return this.splitNode(node, w, h)\n    else\n      return null\n  }\n\n}\n","<template>\n  <div class=\"map-us\">\n\n    <h1>US Counties</h1>\n    <h4>Gather map data</h4>\n     <p>Following <a href=\"https://bl.ocks.org/mbostock/4136647\">this D3 example</a>,\n    Create a SVG map of {{counties.length.toLocaleString()}} US counties.</p>\n    <svg\n      ref=\"map-svg\"\n      class=\"map-svg\"\n      viewBox=\"0 0 960 600\"\n      preserveAspectRatio=\"xMidYMid meet\"></svg>\n\n    <hr/>\n\n    <h4>Export Counties One by One</h4>\n    <p> Next use <em>getBBox()</em> to get each county bounds</p>\n    <br/>\n    <svg\n      @click=\"randomize\"\n      ref=\"test-svg\"\n      class=\"test-svg\"\n      preserveAspectRatio=\"xMidYMid meet\"></svg>\n    <br/>\n    <em>Click on the SVG to randomize the state</em>\n\n    <hr/>\n\n    <h4>Draw to Canvas</h4>\n    <p>Redraw All {{counties.length.toLocaleString()}} US Counties onto a Canvas, using their coordinates</p>\n    \n    <canvas\n      class=\"counties-canvas\"\n      ref=\"counties-canvas\"\n      />\n\n    <hr/>\n \n    <h4>Pack onto Canvas for Texture</h4>\n    <p>Redraw All {{counties.length.toLocaleString()}} US Counties onto a Canvas, using their packed positions</p>\n   \n    <canvas\n      class=\"packed-counties-canvas\"\n      ref=\"packed-counties-canvas\"\n      />\n\n    <hr/>\n\n    <h4>Upload to the GPU</h4>\n    <p>Each county is mapped to an instanced 3d plane geometry with the right uv map.</p>\n    <h4 class=\"county-label\">{{currentCounty}}</h4>\n    <canvas\n      class=\"counties-webgl-canvas\"\n      ref=\"counties-webgl-canvas\"\n      />\n\n  </div>\n</template>\n\n<script>\n\nimport * as d3 from \"d3\";\nimport * as topojson from 'topojson'\nimport names from '@/data/county-names.json'\nimport us from '@/data/us-10m.v1.json'\nimport GrowingPacker from '@/utils/GrowingPacker'\nimport * as THREE from 'three'\nconst OrbitControls = require('three-orbit-controls')(THREE)\n\nexport default {\n  name: 'home',\n  data: () => ({\n    scale: 1.345,\n        vertexShader: `\n      precision highp float;\n\n      uniform float sineTime;\n\n      uniform float time;\n      uniform mat4 modelViewMatrix;\n      uniform mat4 projectionMatrix;\n\n      attribute vec2 uv;\n      varying vec2 vUv;\n\n      attribute float countyIndex;\n      attribute vec3 position;\n      attribute vec3 offset;\n      attribute vec4 color;\n      attribute vec4 orientationStart;\n      attribute vec4 orientationEnd;\n      attribute vec2 uvOffsets;\n      attribute vec2 uvScales;\n      // varying vec3 vPosition;\n      varying float vCountyIndex;\n\n      void main(){\n        vCountyIndex = countyIndex;\n        vec3 pos = position * vec3(uvScales.xy * 1024.0, 1.0);\n        // pos *= (sin(time*0.6 + offset.x + offset.y) * 2.0)-1.0;\n        pos = pos + offset;\n        // pos.z += sin(time*0.6 + offset.x + offset.y) * 30.0;\n        \n        vUv = vec2(uv.x, 1.0-uv.y);\n        vUv *= uvScales;\n        vUv = vec2(vUv.x, 1.0-vUv.y);\n        vUv += vec2(uvOffsets.x , uvOffsets.y);// * vec2(1.0,-1.0) * uvScales / 1024.0;\n\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( pos, 1.0 );\n      }\n    `,\n    fragmentShader: `\n      precision highp float;\n      uniform float time;\n      // varying vec3 vPosition;\n      varying float vCountyIndex;\n      uniform sampler2D map;\n      uniform float isPicking;\n      varying vec2 vUv;\n      \nvec4 packInt( float c )\n{\t\n  // float alpha = c/(256.0*256.0*256.0) / 256.0;\n  \n  float red = mod(c/(256.0*256.0), 256.0) / 256.0;\n  float green = mod((c/256.0), 256.0) / 256.0;\n  float blue = mod(c, 256.0) / 256.0;\n  return vec4(red, green, blue, 1.0);\n}\n\n\n      void main() {\n        vec4 color = texture2D(map, vUv);\n        if (color.x + color.y + color.z < 0.9) {\n          discard;\n        }\n        if (isPicking == 1.0) {\n          vec4 c = packInt(vCountyIndex);\n          gl_FragColor = c;\n           //vec4(c);//vec4( 1.0, vCountyIndex, 1.0, 1.0 );\n        } else {\n          color.r = sin(time+vCountyIndex) * 0.5 + 0.5;\n          color.g = sin(time*0.7+vCountyIndex) * 0.5 + 0.5;\n          color.b = sin(time*.43+vCountyIndex) * 0.5 + 0.5;\n          gl_FragColor = color;\n        }\n      }\n    `,\n    counties: [],\n    // inactivityTimeout: 10000,\n    canvasWidth: 960,\n    canvasHeight: 600,\n    mouse: {\n      x:0,\n      y:0\n    },\n    currentCounty: null\n  }),\n  mounted () {\n    this.createD3Map()\n    const blocks = this.runTexturePacker()\n    this.drawCounties(blocks)\n    this.createWebGLMap(blocks)\n  },\n  methods: {\n    randomize () {\n      const paths = this.$refs['map-svg'].querySelectorAll('g.counties path')\n      const index = Math.round(Math.random() * paths.length) % paths.length\n      const box = paths[index].getBBox()\n      this.$refs['test-svg'].setAttribute('width', box.width)\n      this.$refs['test-svg'].setAttribute('height', box.height)\n      this.$refs['test-svg'].setAttribute('viewBox', `${box.x} ${box.y} ${box.width} ${box.height}`)\n      this.$refs['test-svg'].append(paths[index].cloneNode(true))\n    },\n    createD3Map () {\n      const svg = d3.select(this.$refs['map-svg'])\n      const path = d3.geoPath()\n      svg.append('g')\n          .attr('class', 'counties')\n        .selectAll('path')\n        .data(topojson.feature(us, us.objects.counties).features)\n        .enter().append('path')\n          .attr('id', e => e.id)\n          .attr('d', path)\n      this.randomize()\n    },\n    runTexturePacker () {\n      const blocks = [...this.$refs['map-svg'].querySelectorAll('g.counties path')]\n        .map(path => {\n          const { x, y, width, height } = path.getBBox()\n          return {\n            id: parseInt(path.getAttribute('id')),\n            x: x * this.scale,\n            y: y * this.scale,\n            w: width * this.scale,\n            h: height * this.scale,\n            path\n          }\n        })\n        .sort((a, b) => (Math.min(b.w, b.h) - Math.min(a.w, a.h)))\n\n      const packer = new GrowingPacker()\n      packer.fit(blocks)\n      return blocks\n    },\n    drawCounties (blocks) {\n      const canvas = this.$refs['counties-canvas']\n      canvas.width = 960\n      canvas.height = 600\n      const context = canvas.getContext('2d')\n      context.strokeStyle = '#000'\n      context.lineWidth = 0\n      context.fillStyle = '#000'\n\n      const canvasPacked = this.$refs['packed-counties-canvas']\n      canvasPacked.width = 1024\n      canvasPacked.height = 1024\n      const contextPacked = canvasPacked.getContext('2d')\n      contextPacked.strokeStyle = 'transparent'\n      contextPacked.lineWidth = 0\n      // contextPacked.fillStyle = 'white'\n\n      let i = 0\n      for(let block of blocks) {\n        if (block.fit) {\n\n          const path = new Path2D(block.path.getAttribute('d'))\n\n          context.fillStyle = `hsl(${360 * Math.random()}, 50%, 50%)`\n          context.stroke(path)\n          context.fill(path)\n          context.restore()\n\n          contextPacked.save()\n          contextPacked.fillStyle = `hsl(${360 * Math.random()}, 50%, 50%)`\n          contextPacked.translate(-block.x, -block.y)\n          contextPacked.translate(block.fit.x, block.fit.y)\n          contextPacked.scale(this.scale, this.scale)\n          contextPacked.stroke(path)\n          contextPacked.fill(path)\n\n// contextPacked.fillStyle = `hsl(${360 * Math.random()}, 20%, 20%)`\n//           // const rect = \n//           contextPacked.strokeStyle=\"red\";\n//           contextPacked.rect(0,0, block.w, block.h)\n          // contextPacked.stroke()\n          // contextPacked.fill()\n\n          contextPacked.restore()\n\n        } else {\n          // eslint-disable-next-line\n          console.warn(`Error packing county at ${i}`)\n        }\n        i++\n      }\n      this.counties.push(...blocks)\n      // let min = Infinity\n      // let atMin\n      // let max = -Infinity\n      // let atMax\n      // for(let block of blocks) {\n      //   if(block.id > max) {\n      //     atMax = block\n      //     max = block.id\n      //   }\n      //   if(block.id < min) {\n      //     atMin = block\n      //     min = block.id\n      //   }\n      // }\n      // console.log({blocks, min, atMin, max, atMax})\n    },\n    createWebGLMap (blocks) {\n      var camera, scene, renderer, controls, mouseIsDown = false\n      // var pickingData, pickingRenderTarget, pickingScene\n      var clock = new THREE.Clock()\n      var mesh\n      var pickingRenderTarget\n      // var pickingScene\n      // var highlightBox\n      var pixelBuffer = new Uint8Array(4)\n      var canvas = this.$refs['counties-webgl-canvas']\n      const init = () => {\n        renderer = new THREE.WebGLRenderer({\n          canvas: canvas,\n          antialias: true,\n          alpha: true\n        })\n        renderer.setPixelRatio( window.devicePixelRatio )\n        renderer.setSize( this.canvasWidth, this.canvasHeight )\n        if ( renderer.extensions.get( 'ANGLE_instanced_arrays' ) === null ) {\n          alert(\"This experiment is not supoprted by your browser.\")\n          return\n        }\n        // camera = new THREE.PerspectiveCamera( 50, window.innerWidth / window.innerHeight, 1, 100000 );\n        camera = new THREE.PerspectiveCamera( 50, this.canvasWidth / this.canvasHeight, 1, 100000 );\n        camera.position.z = 1000\n\n        scene = new THREE.Scene()\n\n        controls = new OrbitControls(camera)\n        // controls = new OrbitControls(camera, renderer.domElement)\n        controls.enableKeys = true\n        controls.enableZoom = false\n        controls.maxPolarAngle = Math.PI / 2\n        // geometry\n        document.addEventListener('keydown', e => {\n          if (e.key == '=') {\n            camera.position.z -= 50\n            render(clock.getDelta())\n          } else if (e.key == '-') {\n            camera.position.z += 50\n            render(clock.getDelta())\n          }\n        })\n\n\n// pickingScene = new THREE.Scene()\n// pickingData = {}\n// picking render target\npickingRenderTarget = new THREE.WebGLRenderTarget(\n  this.canvasWidth, this.canvasHeight\n)\npickingRenderTarget.texture.generateMipmaps = false\npickingRenderTarget.texture.minFilter = THREE.NearestFilter\n\n// // highlight box\n// highlightBox = new THREE.Mesh(\n//   new THREE.BoxBufferGeometry( 1, 1, 1 ),\n//   new THREE.MeshLambertMaterial( {\n//     emissive: 0xffff00,\n//     transparent: true,\n//     opacity: 0.5\n//   } )\n// )\n\n// var pickingMaterial = new THREE.RawShaderMaterial( {\n// \t\t\t\tvertexShader: \"#define PICKING\\n\" + this.vertexShader,\n// \t\t\t\tfragmentShader: \"#define PICKING\\n\" + this.fragmentShader,\n// \t\t\t\tuniforms: {\n// \t\t\t\t\t// pickingColor: {\n// \t\t\t\t\t// \tvalue: new THREE.Color()\n// \t\t\t\t\t// }\n// \t\t\t\t}\n//       } );\n// var debug = new\n\n        var instances = blocks.length\n        var countyIndexes = []\n        var offsets = []\n        var uvOffsets = []\n        var uvScales = []\n        let i = 0\n        for (let block of blocks) {\n          i++\n          countyIndexes.push(i)\n          // countyIndexes.push(block.id)\n          offsets.push( \n            block.x - 650 + block.w/2,\n            -block.y + 380 - block.h/2,\n            0\n          )\n          uvOffsets.push(\n            (block.fit.x) / 1024,\n            -(block.fit.y) / 1024\n          )\n          uvScales.push(\n            block.w / 1024,\n            block.h / 1024\n          )\n        }\n\n        var geometry = new THREE.InstancedBufferGeometry()\n        geometry.copy( new THREE.PlaneBufferGeometry(1, 1, 1, 1))\n    \n        geometry.maxInstancedCount = instances; // set so its initalized for dat.GUI, will be set in first draw otherwise\n\n        geometry.addAttribute( 'countyIndex', new THREE.InstancedBufferAttribute( new Float32Array( countyIndexes ), 1 ) );\n        geometry.addAttribute( 'offset', new THREE.InstancedBufferAttribute( new Float32Array( offsets ), 3 ) );\n        geometry.addAttribute( 'uvOffsets', new THREE.InstancedBufferAttribute( new Float32Array( uvOffsets ), 2 ) );\n        geometry.addAttribute( 'uvScales', new THREE.InstancedBufferAttribute( new Float32Array( uvScales ), 2 ) );\n        var canvasTexture = new THREE.CanvasTexture(this.$refs['packed-counties-canvas'])\n        // canvasTexture.wrapS = canvasTexture.wrapT = THREE.RepeatWrapping;\n        // canvasTexture.repeat.set(1024, 1024)\n\n        var material = new THREE.RawShaderMaterial( {\n          uniforms: {\n            map: { value: canvasTexture },\n            time: { value: 1.0 },\n            sineTime: { value: 1.0 },\n            isPicking: { type: 'f', value: 0.0 }\n          },\n          vertexShader: this.vertexShader,\n          fragmentShader: this.fragmentShader,\n          side: THREE.FrontSide,\n          // side: THREE.DoubleSide,\n          transparent: true\n        } );\n\n        //\n\n        mesh = new THREE.Mesh( geometry, material );\n        scene.add( mesh );\n\n        window.addEventListener( 'resize', onWindowResize, false );\n        // const TIMEOUT = 10000\n        // this.inactivityTimeout = TIMEOUT\n        // window.addEventListener( 'touchstart', () => this.inactivityTimeout = TIMEOUT, false )\n        // window.addEventListener( 'mousedown', () => this.inactivityTimeout = TIMEOUT, false )\n        // window.addEventListener( 'touchcancel', () => this.inactivityTimeout = TIMEOUT, false )\n        // window.addEventListener( 'touchend', () => this.inactivityTimeout = TIMEOUT, false )\n        // window.addEventListener( 'mouseup', () => this.inactivityTimeout = TIMEOUT, false )\n        // window.addEventListener( 'mouseout', () => this.inactivityTimeout = TIMEOUT, false )\n        canvas.addEventListener( 'touchstart', () => mouseIsDown = true, false )\n        canvas.addEventListener( 'mousedown', (event) => {\n          mouseIsDown = true,\n          // var xScrollPos = canvas.scrollLeft\n          // var yScrollPos = canvas.scrollTop\n          this.mouse.x = event.pageX - canvas.offsetLeft\n          this.mouse.y = event.pageY - canvas.offsetTop\n          // console.log('canvas:', canvas)\n          // this.mouse.x = (canvas.offsetLeft - canvas.scrollLeft + canvas.clientLeft)\n          // this.mouse.y = (canvas.offsetTop - canvas.scrollTop + canvas.clientTop)\n          samplePoint()\n\n        }, false )\n        canvas.addEventListener( 'touchcancel', () => mouseIsDown = false, false )\n        canvas.addEventListener( 'touchend', () => mouseIsDown = false, false )\n        canvas.addEventListener( 'mouseup', () => mouseIsDown = false, false )\n        canvas.addEventListener( 'mouseout', () => mouseIsDown = false, false )\n\n\n      }\n\n      const onWindowResize = () => {\n\n        camera.aspect = this.canvasWidth / this.canvasHeight;\n        // camera.aspect = window.innerWidth / window.innerHeight;\n        camera.updateProjectionMatrix();\n\n        renderer.setSize( this.canvasWidth, this.canvasHeight );\n        render(clock.getDelta())\n      }\n\n      const animate = () => {\n        requestAnimationFrame( animate );\n        var time = clock.getDelta()\n        if (mouseIsDown) {\n          render(time)\n        }\n      }\n\n      const render = (time) => {\n        // console.log(elapsedTime)\n        var object = scene.children[ 0 ];\n        object.material.uniforms.time.value = object.material.uniforms.time.value + time * 1\n        // object.material.uniforms.time.value = time * 0.005;\n        renderer.render( scene, camera );\n      }\n\n      const samplePoint = () => {\n        // console.log('Sample point', this.mouse.x, this.mouse.y)\n        // object.material.uniforms.isPicking.value = 1\n        mesh.material.uniforms.isPicking.value = 1\n        mesh.material.uniforms.isPicking.needsUpdate = true\n        renderer.render( scene, camera, pickingRenderTarget, true)\n        renderer.readRenderTargetPixels(\n          pickingRenderTarget,\n          this.mouse.x,\n          pickingRenderTarget.height - this.mouse.y,\n          1,\n          1,\n          pixelBuffer\n        );\n\n        // interpret the pixel as an ID\n        var id =\n          ( pixelBuffer[ 0 ] << 16 ) |\n          ( pixelBuffer[ 1 ] ) << 8 |\n          ( pixelBuffer[ 2 ] );\n        if (id > 0) {\n          const index = id-1\n          if (!(index in this.counties)) {\n            // eslint-disable-next-line\n            console.log('ERROR!', id)\n          }\n          const code = this.counties[index].id\n          const name = names[code]\n          // eslint-disable-next-line\n          this.currentCounty = 'County of ' + name\n          // eslint-disable-next-line\n          console.log('County of', name, {index, code, mouse:this.mouse})\n        } else {\n          this.currentCounty = null\n        }\n        mesh.material.uniforms.isPicking.value = 0\n      }\n\n      init()\n      animate()\n      render(clock.getDelta())\n\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.map-us {\n  .map-svg {\n    width: auto;\n    max-width: 960px;\n    path {\n      cursor: pointer;\n      fill: rgba(255,255,255,0.0);\n      stroke: black;\n      stroke-width: 0.2px;\n      transition: fill ease 300ms;\n      &:hover {\n        transition: fill ease 20ms;\n        fill: rgba(25,25,25,0.3);\n      }\n    }\n  }\n  .test-svg {\n    width: auto;\n    min-height: 40px;\n    background: black;\n    cursor: pointer;\n    path {\n      fill: red;\n      stroke: none;\n      stroke-width: 0;\n    }\n  }\n  .counties-canvas {\n    max-width: 960px;\n    width: auto;\n  }\n  .packed-counties-canvas {\n    max-width: 960px;\n  }\n  .county-label {\n    position: absolute;\n    width: 100%;\n    margin-top: 40px;\n    font-size: 30px;\n  }\n  .counties-webgl-canvas {\n    margin: 0 auto;\n    height: auto;\n  }\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapUS.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapUS.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MapUS.vue?vue&type=template&id=f3899f78&\"\nimport script from \"./MapUS.vue?vue&type=script&lang=js&\"\nexport * from \"./MapUS.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MapUS.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"MapUS.vue\"\nexport default component.exports","import Vue from 'vue'\nimport Router from 'vue-router'\nimport MapUS from './views/MapUS.vue'\n\nVue.use(Router)\n\nexport default new Router({\n  // mode: 'history',\n  routes: [\n    {\n      path: '/',\n      name: 'home',\n      component: MapUS\n    },\n    // {\n    //   path: '/about',\n    //   name: 'about',\n    //   // route level code-splitting\n    //   // this generates a separate chunk (about.[hash].js) for this route\n    //   // which is lazy-loaded when the route is visited.\n    //   component: () => import(/* webpackChunkName: \"about\" */ './views/About.vue')\n    // }\n  ]\n})\n","import Vue from 'vue'\nimport Vuex from 'vuex'\n\nVue.use(Vuex)\n\nexport default new Vuex.Store({\n  state: {\n\n  },\n  mutations: {\n\n  },\n  actions: {\n\n  }\n})\n","import Vue from 'vue'\nimport App from './App.vue'\nimport router from './router'\nimport store from './store'\n\nVue.config.productionTip = false\n\nnew Vue({\n  router,\n  store,\n  render: h => h(App)\n}).$mount('#app')\n","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=scss&\""],"sourceRoot":""}